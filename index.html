<!-- Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT License. -->
<!DOCTYPE html>
<html>

<head>
    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
</head>

<body>
    <p>This add-in will insert the text 'Hello world!' in a new message.</p>
    <button id="helloButton">Say hello</button>
  
</body>

<script>

            Office.onReady(function() {
          // Register event handler for incoming messages
                console.log("Office on Ready");
              Office.context.mailbox.item.addHandlerAsync(
                Office.EventType.ItemChanged,
                respondToEmail
              );
            });

        function respondToEmail(eventArgs) {
          // Check if the message is an incoming email
          if (eventArgs.item.itemType === Office.MailboxEnums.ItemType.Message && eventArgs.item.itemClass === 'IPM.Note') {

            // Get the sender email address and subject line
            var sender = eventArgs.item.sender.emailAddress;
            var subject = eventArgs.item.subject;
            console.log("Respond to email function");

            // Compose a reply message
            var reply = Office.context.mailbox.item.reply();

            // Set the reply message body
            reply.body.setAsync(
              'Thank you for your email. I will get back to you as soon as possible.'
            );

            // Set the reply message subject
            reply.subject.setAsync('Re: ' + subject);

            // Send the reply message
            reply.send();
          }
        }


</script>
</html>

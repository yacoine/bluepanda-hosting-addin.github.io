<!DOCTYPE html>
<html>
  <head>
    <title>Autoresponder Add-in</title>
    <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  </head>
  <body>
    <div id="container">
      <h1>Autoresponder Add-in</h1>
      <p>This add-in will automatically respond to new emails.</p>
    </div>
    <script>
      // Wait for the Office.js library to initialize before running any code
    Office.onReady(function(info) {
        if (info.host === Office.HostType.Outlook){
        // Register the event handler for new email messages
        Office.context.mailbox.item.notificationMessages.addAsync(
          "autoresponder",
          { type: "informationalMessage", message: "Sending auto-response..." },
          { isPersistent: false },
          function(result) {
            // Define the recipient, subject, and body of the email
            var recipient = Office.context.mailbox.item.from.emailAddress;
            var subject = "Auto-Response: " + Office.context.mailbox.item.subject;
            var body = "Thank you for your email. BluePanda will get back to you as soon as possible.";

            // Create a new message
            Office.context.mailbox.displayNewMessageForm({
              toRecipients: [recipient],
              subject: subject,
              body: body
            });

            // Dismiss the notification message
            Office.context.mailbox.item.notificationMessages.removeAsync("autoresponder");
          }
        );
      }
    };

    </script>
  </body>
</html>
